(function () {
        "use strict";
        var mapContainer = document.getElementById("map-container");
        var offsetTop = mapContainer.offsetTop;
        var offsetLeft = mapContainer.offsetLeft;
        var areas = document.querySelectorAll("area");
        for (var i = 0; i < areas.length; i++) {
            var img = new Image();
            var centroid = getAreaCenter(areas[i].getAttribute("coords"));
            img.id = i.toString();
            img.src = {};
            img.className = "hidden";
            document.getElementById("container").appendChild(img);
            img.style.left = centroid[0] + "px";
            img.style.top = centroid[1] + "px";
            img.onload = function () {
                offsetTop = mapContainer.offsetTop;
                offsetLeft = mapContainer.offsetLeft;
                this.style.left = parseInt(this.style.left, 10) - this.width / 2 + "px";
                this.style.top = parseInt(this.style.top, 10) - this.height / 2 + "px";
                this.className = "icons";
                this.style.top = parseInt(this.style.top, 10) + offsetTop + "px";
                this.style.left = parseInt(this.style.left, 10) + offsetLeft + "px";
            }
        }
        document.addEventListener("click", function (e) {
            if (e.target.className === "icons") {
                var boundingBox = e.target.getBoundingClientRect();
                var centerX = boundingBox.width / 2 + boundingBox.left;
                var centerY = boundingBox.top + boundingBox.height / 2;
                document.getElementById("info-box").className = "visible";
                displayBox(centerX, centerY, Number(e.target.id));
            } else {
                hideBox();
            }
        });

        function displayBox(centerX, centerY, id) {
            var infoBox = document.getElementById("info-box");
            var infoWidthToCenter = infoBox.offsetWidth / 2;
            var infoHeight = infoBox.offsetHeight;
            infoBox.innerHTML = infoBoxes[id];
            var left = (document.documentElement && document.documentElement.scrollLeft) || document.body.scrollLeft;
            var top = (document.documentElement && document.documentElement.scrollTop) || document.body.scrollTop;
            infoBox.style.left = (centerX - infoWidthToCenter - offsetLeft) + left + "px";
            infoBox.style.top = (centerY - infoHeight - 15) + top + "px";
        }

        function hideBox() {
            document.getElementById("info-box").className = "hidden";
        }

        function getAreaCenter(coords) {
            var coordsArray = coords.split(","),
                center = [];
            var coord, maxX, maxY, minX = maxX = parseInt(coordsArray[0], 10),
                minY = maxY = parseInt(coordsArray[1], 10);
            for (var i = 0; i < coordsArray.length; i++) {
                coord = parseInt(coordsArray[i], 10);
                if (i % 2 === 0) {
                    if (coord < minX) {
                        minX = coord;
                    } else if (coord > maxX) {
                        maxX = coord;
                    }
                } else {
                    if (coord < minY) {
                        minY = coord;
                    } else if (coord > maxY) {
                        maxY = coord;
                    }
                }
            }
            center = [parseInt((minX + maxX) / 2, 10), parseInt((minY + maxY) / 2, 10)];
            return center;
        }